<!DOCTYPE html>
<html lang="en" class="full">
	<head>
		<title>S6 Project</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="This is the logbook page for Thomas Abdallah"/>
		<meta name="robots" content="noindex nofollow"/>
		<meta http-equiv="author" content="Thomas Abdallah"/>
		<meta http-equiv="pragma" content="no-cache"/>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<link href="./css/project_common_style.css" type="text/css" rel="stylesheet">
	</head>

	<body>
		<div id="page">
			<!-- Header -->
			<header>
				<nav class="navbar navbar-inverse navbar-fixed-top">
					<div class="container">
						<div class="navbar-header">
							<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>                        
							</button>
							<a class="navbar-brand" href="index.html">S6 Project</a>
						</div>
						
						<div class="collapse navbar-collapse" id="myNavbar">
							<ul class="nav navbar-nav">
								<li><a href="about.html">About</a></li>
								<li><a href="project_plan.html">Project</a></li>
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Logbooks <span class="caret"></span></a>
									<ul class="dropdown-menu">
										<li><a href="stan_rashevskyi_log_book.html">Stan Rashevskyi</a></li>
										<li class="active"><a href="david_eelman_log_book.html">David Eelman</a></li>
										<li><a href="thomas_abdallah_log_book.html">Thomas Abdallah</a></li>
									</ul>
								</li>
							</ul>
							<ul class="nav navbar-nav navbar-right">
								<li><a href="login.html"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
							</ul>
						</div>
					</div>
				</nav>
			</header>

			<!-- Logbook Page -->
			<div id="content">
				<article>
					<div class="container text-center" style="background-color: rgba(0,0,0,0.4)">
						<h1>Weekly Log Book - Thomas Abdallah</h1>
						<hr class="top center-block">
						<img src="images/thomas.jpg" alt="Image of Thomas" title="Handsome" class="img-rounded" />

						<div class="row text-left center-block">
							<div class="col-xs-12">
								<hr>
								<h2>Week 1</h2>
								<ul>
									<li>Worked with Stan and David to develop project plan</li>
									<li>Developed CAN firmware for HCS12 microcontroller</li>
									<li>Debugged issues with CAN Rx ISR causing 'illegal bp' (unresolved)</li>
								</ul>
							</div>
							<div class="col-xs-12">
								<hr>								
								<h2>Week 2</h2>
								<ul>
									<li>Developed <a href= "https://github.com/eelmand/S6Project/blob/master/Project%20Plan/Elevator_CAN_Network.pdf">CAN network layout</a> and <a href= "https://github.com/eelmand/S6Project/blob/master/Project%20Plan/Shared_CAN_Protocol_Proposal.xlsx">protocol proposal</a> with Stan and David</li>
									<li>Reviewed proposal with class - agreed to all use same protocol and network layout at 125kBaud</li>
									<li>Fixed issues with CAN Rx ISR causing 'illegal bp'</li>
									<ul>
										<li>Was caused by initializing the timer module with overflow interrupts enabled, but forgot to include the interrupt handler in the project</li>
									</ul>
									<li>Implemented a FIFO library for storing Rx CAN messages</li>
									<ul>
										<li>Using dynamic memory allocation on the HCS12 (i.e. malloc) requires rebuilding the libraries with a sensible heap size</li>
										<li>Default heap size is 2000 bytes which is more than the available amount of RAM on our chip - this causes errors during linking</li>
										<li><a href= "https://community.nxp.com/thread/388977">Instructions for rebuilding the libraries</a></li>
									</ul>
									<li>Started implementing "Elevator Controller" module</li>
									<ul>
										<li>Using my own project board from Semester 4 as it already has a Scmitt trigger and a DAC</li>
										<li>Ultrasonic sensor implementation complete</li>
										<ul>
											<li>Using OC to send the 'trigger' pulse (10uS @20mS period) to the sensor</li>
											<li>Using IC to measure the 'echo' waveform pulse width</li>
											<ul>
												<li>Distance (cm) = Pulse Width (uS) / 58</li>
												<li>IC is messy without a Schmitt trigger to clean up the input signal</li>
												<li>Using the encoder input on my board as it already has this</li>
											</ul>
											<li>Using LCD to display the current distance measurement in cm</li>
										</ul>
										<li>Motor control implementation started</li>
										<ul>
											<li>Using SPI controlled DAC to send analog voltage to servo-amp</li>
											<li>Working on closed-loop control today (2017-05-19)</li>
										</ul>
									</ul>
								</ul>
							</div>
							<div class="col-xs-12">
								<hr>
								<h2>Week 3</h2>
								<ul>
									<li>Finished elevator controller implementation</li>
									<ul>
										<li>Using input-capture to measure ultrasonic sensor distance and convert to 'floor number'</li>
										<li>Using SPI controlled DAC to control motor voltage</li>
										<li>Closed loop (PI) controller implemented based on floor request</li>
										<li>Fully validated - code frozen and ready for entire class to use</li>
									</ul>
									<li>Installed PCAN Linux drivers</li>
									<ul>
										<li><a href= "http://www.peak-system.com/forum/viewtopic.php?f=59&t=256">This is not straight forward</a></li>
										<li>Drivers do not stay installed after rebooting Virtual Machine - okay for now</li>
									</ul>
									<li>Installed PCAN Basic API (Python and C++ support)</li>
									<li>Started playing with PCAN Basic API in Python to initialize and Tx/Rx messages</li>
									<li>Implemented a basic "SC" Python script that just sends commands to EC and prints out status stuff</li>
									<li><a href= "https://eelmand.github.io/S6Project/Website/about.html#sc_state_machine">Designed state machine for SC</a></li>
									<li>Implemented State Machine in Python - Supervisory Controller fully functional</li>
									<li>Worked with David to build 2 more floor controllers and set up a table for our CAN network testing</li>
									<li>Started testing complete CAN network (simulating Car Controller with USB to CAN device)</li>
								</ul>
							</div>
						</div>
					</div>
				</article>
			</div>

			<footer class="container-fluid text-center">
				<p>Copyright &copy; 2017 ESE Team</p>
			</footer>
		</div>
	</body>
</html>